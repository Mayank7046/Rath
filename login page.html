<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Ride Booking</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Custom Styles -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .toggle-label {
            transition: color 0.4s ease-in-out;
        }
        /* This CSS rule ONLY handles the sliding transform */
        #toggle:checked ~ .toggle-bg {
            transform: translateX(100%);
        }
        .reason-item {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .login-card {
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-100 via-purple-100 to-pink-100 flex items-center justify-center h-screen p-4">

    <div class="login-card w-full max-w-md p-8 space-y-6 bg-white/70 rounded-2xl shadow-2xl border border-white/50">
        <div>
            <h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">
                Welcome Back!
            </h2>
            <p id="welcomeMessage" class="mt-2 text-center text-sm text-gray-600 h-4"></p>
        </div>

        <!-- Toggle Switch -->
        <div class="flex justify-center">
            <div class="relative w-64 h-12 flex items-center bg-gray-200 rounded-full p-1 cursor-pointer">
                <input type="checkbox" id="toggle" class="sr-only">
                <!-- The sliding background element. Gradient is now fully controlled by JS -->
                <div id="toggle-bg" class="absolute left-1 top-1 w-1/2 h-10 rounded-full shadow-md transform transition-all duration-400 ease-in-out"></div>
                <label for="toggle" id="clientLabel" class="toggle-label flex-1 text-center z-10 font-semibold text-white">Client</label>
                <label for="toggle" id="riderLabel" class="toggle-label flex-1 text-center z-10 font-semibold text-gray-500">Rider</label>
            </div>
        </div>

        <!-- Login Form -->
        <form class="mt-8 space-y-6" action="#" method="POST">
            <input type="hidden" name="remember" value="true">
            <div class="rounded-md shadow-sm -space-y-px">
                <!-- Email Input -->
                <div>
                    <label for="email-address" class="sr-only">Email address</label>
                    <input id="email-address" name="email" type="email" autocomplete="email" required class="appearance-none rounded-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm bg-white/80" placeholder="Email address">
                </div>
                <!-- Password Input -->
                <div>
                    <label for="password" class="sr-only">Password</label>
                    <input id="password" name="password" type="password" autocomplete="current-password" required class="appearance-none rounded-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm bg-white/80" placeholder="Password">
                </div>
            </div>

            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <input id="remember-me" name="remember-me" type="checkbox" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                    <label for="remember-me" class="ml-2 block text-sm text-gray-900">
                        Remember me
                    </label>
                </div>

                <div class="text-sm">
                    <a href="#" class="font-medium text-indigo-600 hover:text-indigo-500">
                        Forgot your password?
                    </a>
                </div>
            </div>

            <div>
                <button type="submit" id="loginBtn" class="group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all duration-300 transform hover:scale-105">
                    Sign in as Client
                </button>
            </div>
        </form>
        
        <div class="text-center">
             <a href="#" id="whyChooseUsBtn" class="text-sm font-medium text-indigo-600 hover:text-indigo-500">
                ✨ Why choose us?
            </a>
            <div id="reasonsContainer" class="mt-4 text-left text-sm space-y-2"></div>
        </div>

        <p class="mt-2 text-center text-sm text-gray-600">
            Don't have an account?
            <a href="#" class="font-medium text-indigo-600 hover:text-indigo-500">
                Create one now
            </a>
        </p>
    </div>

    <script>
        const toggle = document.getElementById('toggle');
        const clientLabel = document.getElementById('clientLabel');
        const riderLabel = document.getElementById('riderLabel');
        const loginBtn = document.getElementById('loginBtn');
        const welcomeMessage = document.getElementById('welcomeMessage');
        const whyChooseUsBtn = document.getElementById('whyChooseUsBtn');
        const reasonsContainer = document.getElementById('reasonsContainer');
        const toggleBg = document.getElementById('toggle-bg');

        // --- Gemini API Function ---
        const callGeminiAPI = async (prompt, isJson = false) => {
            const apiKey = ""; // Leave empty, handled by environment
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
            if (isJson) { 
                payload.generationConfig = { 
                    responseMimeType: "application/json",
                    responseSchema: {
                        type: "OBJECT",
                        properties: {
                            reasons: {
                                type: "ARRAY",
                                items: { type: "STRING" }
                            }
                        }
                    }
                };
            }
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                if (!response.ok) throw new Error(`API call failed with status: ${response.status}`);
                const result = await response.json();
                if (result.candidates?.[0]?.content?.parts?.[0]) {
                    return result.candidates[0].content.parts[0].text;
                } else {
                    console.error("Unexpected API response structure:", result);
                    return null;
                }
            } catch (error) {
                console.error("Error calling Gemini API:", error);
                return null;
            }
        };

        const generateWelcomeMessage = async () => {
            const userType = toggle.checked ? 'Rider' : 'Client';
            const prompt = `Generate a very short, friendly, and slightly poetic welcome message for a ${userType} logging into a ride-booking app in India. It's late afternoon. The app has a new colorful design. Just the message, no extra text.`;
            welcomeMessage.textContent = 'Thinking of a nice welcome...';
            const message = await callGeminiAPI(prompt);
            welcomeMessage.textContent = message || `Welcome, ${userType}!`;
        };

        const generateReasons = async () => {
            const userType = toggle.checked ? 'Rider' : 'Client';
            const prompt = `Generate exactly 3 short, compelling reasons why a ${userType.toLowerCase()} in India should choose our ride-booking platform.`;
            reasonsContainer.innerHTML = '<p class="text-center">✨ Thinking of reasons...</p>';
            
            const responseText = await callGeminiAPI(prompt, true);
            reasonsContainer.innerHTML = '';
            
            if (responseText) {
                try {
                    const responseJson = JSON.parse(responseText);
                    if (responseJson.reasons && Array.isArray(responseJson.reasons)) {
                        const list = document.createElement('ul');
                        list.className = 'list-disc list-inside text-gray-600';
                        responseJson.reasons.forEach(reason => {
                            const item = document.createElement('li');
                            item.className = 'reason-item';
                            item.textContent = reason;
                            list.appendChild(item);
                        });
                        reasonsContainer.appendChild(list);
                    } else {
                         throw new Error("Invalid JSON structure");
                    }
                } catch (e) {
                    console.error("Failed to parse reasons:", e);
                    reasonsContainer.innerHTML = '<p class="text-center text-red-500">Could not get reasons at this time.</p>';
                }
            } else {
                reasonsContainer.innerHTML = '<p class="text-center text-red-500">Could not get reasons at this time.</p>';
            }
        };
        
        const updateUserTypeUI = () => {
            reasonsContainer.innerHTML = ''; // Clear reasons on toggle

            // Define classes for the login button gradients
            const clientClasses = ['from-indigo-600', 'to-purple-600', 'hover:from-indigo-700', 'hover:to-purple-700'];
            const riderClasses = ['from-purple-600', 'to-pink-600', 'hover:from-purple-700', 'hover:to-pink-700'];

            if (toggle.checked) {
                // --- RIDER IS SELECTED ---
                // Update toggle labels
                riderLabel.classList.remove('text-gray-500');
                riderLabel.classList.add('text-white');
                clientLabel.classList.add('text-gray-500');
                clientLabel.classList.remove('text-white');
                
                // Update toggle background
                toggleBg.style.background = 'linear-gradient(to right, #8b5cf6, #c084fc)';
                
                // Update login button text and style
                loginBtn.textContent = 'Sign in as Rider';
                loginBtn.classList.remove(...clientClasses);
                loginBtn.classList.add(...riderClasses);

            } else {
                // --- CLIENT IS SELECTED ---
                // Update toggle labels
                clientLabel.classList.remove('text-gray-500');
                clientLabel.classList.add('text-white');
                riderLabel.classList.add('text-gray-500');
                riderLabel.classList.remove('text-white');

                // Update toggle background
                toggleBg.style.background = 'linear-gradient(to right, #4f46e5, #7c3aed)';

                // Update login button text and style
                loginBtn.textContent = 'Sign in as Client';
                loginBtn.classList.remove(...riderClasses);
                loginBtn.classList.add(...clientClasses);
            }
            // Generate a new welcome message for the selected user type
            generateWelcomeMessage();
        }

        toggle.addEventListener('change', updateUserTypeUI);

        whyChooseUsBtn.addEventListener('click', (e) => {
            e.preventDefault();
            generateReasons();
        });

        // Initial load
        window.addEventListener('load', () => {
            // Set initial state correctly
            updateUserTypeUI();
        });
    </script>
</body>
</html>
